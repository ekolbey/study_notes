\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
%\usepackage{fullpage}

\usepackage{graphicx, url}

\usepackage{amsmath, amsfonts, xfrac}
\usepackage{mathtools}

\usepackage{tikz}
\usetikzlibrary{shapes}
\colorlet{light blue}{blue!50}

\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}

\newcommand{\obj}[1]{{\left\{ #1 \right \}}}
\newcommand{\clo}[1]{{\left [ #1 \right ]}}
\newcommand{\clop}[1]{{\left [ #1 \right )}}
\newcommand{\ploc}[1]{{\left ( #1 \right ]}}

\newcommand{\brac}[1]{{\left ( #1 \right )}}
\newcommand{\crab}[1]{{\left ] #1 \right [}}
\newcommand{\induc}[1]{{\left . #1 \right \vert}}
\newcommand{\abs}[1]{{\left | #1 \right |}}
\newcommand{\nrm}[1]{{\left\| #1 \right \|}}
\newcommand{\brkt}[1]{{\left\langle #1 \right\rangle}}

\newcommand{\floor}[1]{{\left\lfloor #1 \right\rfloor}}

\newcommand{\Rbar}{{\bar{\mathbb{R}}}}
\newcommand{\Real}{{\mathbb{R}}}
\newcommand{\Zinf}{{\clo{ 0, +\infty }}}
\newcommand{\Cplx}{{\mathbb{C}}}
\newcommand{\Tcal}{{\mathcal{T}}}
\newcommand{\Dcal}{{\mathcal{D}}}
\newcommand{\Hcal}{{\mathcal{H}}}
\newcommand{\Ccal}{{\mathcal{C}}}
\newcommand{\Scal}{{\mathcal{S}}}
\newcommand{\Ncal}{{\mathcal{N}}}
\newcommand{\Ecal}{{\mathcal{E}}}
\newcommand{\Fcal}{{\mathcal{F}}}
\newcommand{\borel}[1]{{\mathcal{B}\brac{#1}}}
\newcommand{\Ex}[0]{{\mathbb{E}}}
\newcommand{\pr}[0]{{\mathbb{P}}}
\newcommand{\Var}[1]{{\text{Var}\brac{#1}}}

\newcommand{\pwr}[1]{{\mathcal{P}\brac{#1}}}
\newcommand{\Dyns}[1]{{\mathfrak{D}\brac{#1}}}
\newcommand{\Ring}[1]{{\mathcal{R}\brac{#1}}}
\newcommand{\Supp}[1]{{\operatorname{supp}\nolimits\brac{#1}}}

\newcommand{\defn}{{\mathop{\overset{\Delta}{=}}\nolimits}}
\newcommand{\lpto}{{\mathop{\overset{L^p}{\to}}\nolimits}}

\newcommand{\re}{\operatorname{Re}\nolimits}
\newcommand{\im}{\operatorname{Im}\nolimits}

\usepackage[english, russian]{babel}
\newcommand{\eng}[1]{\foreignlanguage{english}{#1}}
\newcommand{\rus}[1]{\foreignlanguage{russian}{#1}}

\title{\rus{Домашняя работа по курсу \\ ``Теоретико-вероятностные методы в статистике''}}
\author{\rus{Назаров Иван,} \rus{101мНОД(ИССА)}}

\begin{document}
\selectlanguage{russian}
\maketitle

\section{У1.8 -- Задача о сборщике купонов} % (fold)
\label{sec:task_1_8}

Пусть $\Omega$ -- множество возможных купонов, $\abs{\Omega} = k$. 

Предположим, пачки овсянки пронумерованы в порядке их покупки или согласно
серийному номеру самой упаковки.
Пусть $\Omega$ -- множество всевозможных цветов купонов, $\abs{\Omega} = k \geq 2$.
Каждый набор купонов на $n$ купленных пачек овсянки можно сопоставить набору
$\brac{a_i}_{i=1}^n \in \Omega^n$, где $a_i\in \Omega$ -- цвет купона на пачке $i$.

Подсчитаем количество ``плохих'' конфигураций в $\Omega^n$ -- тех в которых
отсутствуют купоны хотя бы одного цвета $c\in\Omega$.
Введём обозначение множества конфигураций, в которых нет цвета $c\in \Omega$ :
\[ A_c \defn \obj{ \induc{ w\in \Omega^n }\, w_i \neq c,\, \forall i = 1,\ldots,n } \]
Тогда искомые конфигурации есть ни что иное как объединение $A \defn \bigcup_{c\in \Omega} A_c$.

Воспользуемся формулой включений-исключений, которая в случае данной постановки
задачи имеет вид:
\[\abs{ \bigcup_{c\in \Omega} A_c } = \sum_{\emptyset \neq C\subseteq \Omega}
\brac{-1}^{\abs{C} - 1} \abs{\cup_{c\in C} A_c} \]
Для любого непустого $C\subseteq \Omega$ мощность множества $\cup_{c\in C} A_c$
равна $\brac{\abs{\Omega} - \abs{C}}^n$.

Таким образом \begin{align*}
	\abs{ \bigcup_{c\in \Omega} A_c } &= \sum_{\emptyset \neq C\subseteq \Omega}
		\brac{-1}^{\abs{C} - 1} \brac{\abs{\Omega} - \abs{C}}^n \\
		&= \sum_{m=1}^k C^m_k {(-1)}^{m-1} {(k - m)}^n
\end{align*}
где $C^m_k = \frac{k!}{m!(k-m)!}$ -- число неупорядоченных перестановок из $n$ по $k$ элементов.
При этом количество всевозможных конфигураций цветов купонов на $n$ различимых
пачках составляет $\abs{\Omega}^n$ штук.

Количество конфигураций $n$ различимых упаковок, в которых присутствуют все $k$ цветов,
равно разности числа всех конфигураций и числа конфигураций, хотя бы без одного цвета.
Итак
\begin{align*}
	Q_n & = \abs{\Omega}^n - \abs{ \bigcup_{c\in \Omega} A_c } \\
	& = k^n - \sum_{m=1}^k C^m_k {(-1)}^{m-1} {(k - m)}^n \\
	& = \sum_{m=0}^k C^m_k {(-1)}^m {(k - m)}^n \\
	& = k! \left\{\begin{matrix} n \\ k \end{matrix}\right\}
\end{align*}
где $\left\{\begin{matrix} n \\ k \end{matrix}\right\}$ -- число Стирлинга второго рода,
отражающее количество разбиений $n$ элементного множества на $k$ непустых групп.

Итак вероятность 


% k = 4 ; n = 4
% res <- replicate( sample( k, n, replace = TRUE ), n = 10000, simplify = FALSE )
% b <- sapply( sapply( res, unique ), length )
% sum( b == k ) / length( b )

% section task_1_8 (end)


\section{У1.11 -- } % (fold)
\label{sec:task_1_11}

Пусть $N$ -- неотрицательная дискретная случайная величина, принимающая
целочисленные значения, с производящей функцией $G(z) = \Ex(z^N)$.
Пусть $\brac{E_k}_{k\geq 1}$ независимые одинаково распределённые дискретные
случайные величины, с производящей функцией $H(z)$.

Рассмотрим случайную величину $S \defn \sum_{k=1}^N E_k$, где предполагается,
что $\sum_{k=1}^N$ равно $0$ при $N=0$. Воспользовавшись свойствами условного
математического ожидания, в том числе ``телескопическим'' свойством, и тем,
что ожидание произведения независимых случайных величин равно произведению
их ожиданий, производящая функция $S$ принимает вид:
\begin{align*}
	F(z) &= \Ex\brac{ z^{\sum_{k=1}^N E_k} }
	= \Ex\brac{ z^{\sum_{k=1}^N E_k} } \\
	& = \Ex\brac{ \Ex\brac{\induc{z^{\sum_{k=1}^N E_k} }\,N} }
	= \Ex\brac{ \Ex\brac{\induc{\prod_{k=1}^N z^{E_k} }\,N} } \\
	& = \Ex\brac{ \prod_{k=1}^N \Ex\brac{\induc{z^{E_k} }\,N} }
\end{align*}
Поскольку $E_k\perp N$ и для любого $k\geq 1$, то $\Ex\brac{\induc{z^{E_k} }\,N}$
равно $\Ex(z^{E_k})$, что, в свою очередь, равно производящей функции величины $E_k$.
Таким образом,
\[F(z) = \Ex\brac{ \prod_{k=1}^N \Ex\brac{\induc{z^{E_k} }\,N} }
= \Ex\brac{ \prod_{k=1}^N H(z) } = \Ex\brac{ \brac{H(z)}^N } = G\brac{H(z)}\]

Положим, что $\brac{E_k}_{k\geq 1}$ есть семейство независимых между собой и
от $N$ одинаково распределённых случайных величин со значениями в $\obj{0,1}$,
причём \[\Pr(E_k = 1) = \alpha \in \clo{0,1}\] для любого $k\geq 1$.
Непосредственные вычисления показывают, что для любого $k\geq1$ справедливо
\[H(z) = \Ex(z^{E_k}) = z^0 (1-\alpha) + z^1 \alpha = 1 + (z-1) \alpha\]

Образуем случайную величину $T_\alpha N$ аналогично $S$: $T_\alpha N \defn \sum_{k=1}^N E_k$
Тогда, $F(z) = G\brac{1 + (z-1) \alpha}$.

Факториальный момент порядка $k$ произвольной случайной величины $X$ с
производящей функцией $G_X$ равен
\[ \Ex X^{\underline{k}} \Ex\brac{X(X-1)\cdot\ldots\cdot(X_k+1)} = \induc{\frac{d^k}{dz^k} G_X(z) }_{z=1}\]

В случае прореженной случайной величины $T_\alpha N$ по правилу взятия
производной от композиции дифференцируемых функций и в силу того, что
$\frac{d}{dz}H(z) = \alpha$, справедливо следующее: 
\[\Ex {T_\alpha N}^{\underline{k}} = \induc{\frac{d^k}{dz^k} G\brac{H(z)} }_{z=1}
= \alpha^k\induc{\frac{d^k}{dx^k} G(x) }_{x=1}\]

Действительно, индукцией по порядку производной $k$ \begin{align*}
	\frac{d^{k+1}}{dz^{k+1}} G\brac{H(z)} & = \frac{d}{dz}\brac{ \frac{d^k}{dz^k} G\brac{H(z)} } = \frac{d}{dz}\brac{ \induc{\frac{d^k}{dx^k} G(x) }_{x=H(z)} \alpha^k }\\
	& = \frac{d}{dz}\brac{ \induc{\frac{d^k}{dx^k} G(x) }_{x=H(z)} \alpha^k } = \induc{\frac{d^{k+1}}{dx^{k+1}} G(x) }_{x=H(z)} H'(z) \alpha^k\\
	\frac{d}{dz} G\brac{H(z)} & = \induc{\frac{d}{dx} G(x) }_{x=H(z)} \frac{d}{dz} H(z) = G'\brac{H(z)} \alpha
\end{align*}

% Прореживание биномиального, отрицательного биномиального, геометрического и Пуассона

% section task_1_11 (end)

\section{У1.13 -- Красавица и чудовище} % (fold)
\label{sec:task_1_13}

Согласно условию задачи, структура, образуемая горницами и проходами
между ними, представляет собой не просто связный ациклический граф, а
сбалансированное корневое дерево, в котором у каждого узла есть $k$
дочерних узла.
Горницы соответствуют узлам, а переходы в горницы следующего яруса
-- рёбрам дерева.

Согласно условию задачи красная девица движется по дереву согласно
проходимости рёбер, начиная своё ``блуждание'' с горницы, выходящей на
широкое поле, -- из корневой вершины дерева.

Пусть $\pi_n$ вероятность того, что из некоторого узла уровня $n$
не существует ни одного пути через узлы нижних уровней к листьям дерева
-- к горницам последнего яруса, где есть окна (см. рис~\ref{fig:tree_structure}).

% http://texographie.fr/2014/09/arbres-probabilite-forest/
%% Рисуем часть дерева горниц от уровня {n+1} до {n}
\begin{figure}[htb]\begin{center}
%% Задаём стили вершин дерева и меток рёбер.
	\tikzstyle{tree} = [isosceles triangle, shape border rotate = 90, % isosceles triangle stretching = True,
		fill = none, thick, draw, minimum height = 2em, minimum width = 1cm]
	\tikzstyle{door} = [minimum width = 1em, minimum height = 1em, yshift = -1.5em]
	\tikzstyle{passable} = [midway, fill = white] % , circle, draw]

	\begin{tikzpicture}[level/.style={sibling distance = 15mm/#1, level distance = 25mm }]
	\node [door] (root) {$\pi_{n+1}$} [child anchor = north]
		child { node [tree] (s1) {$\pi_n$} { node[door] {$1$} }
			 edge from parent node [passable] {$p$} }
		child { node [tree] (s2) {$\pi_n$} { node[door] {$2$} }
			 edge from parent node [passable] {$p$} }
		child { node[draw=none] (hidden) {} edge from parent[draw=none] }
		child { node [tree] (sk) {$\pi_n$} { node[door] {$k$} }
			 edge from parent node [passable] {$p$} };
	\path (s2) -- (sk) node [midway, above] {$\cdots$};
	\end{tikzpicture}

	\caption{Общий вид поддерева переходов между комнатами из
	узла уровня $n+1$ через горницы уровня $n$ вниз к ``листьям''.}
\label{fig:tree_structure}
\end{center}\end{figure}

Очевидно, что $\xi_n = 1 - \pi_n$ есть вероятность того, что из узла
уровня $n$ существует хотя бы один путь через горницы последующих
ярусов (уровни уменьшаются с ростом яруса и наоборот).

Пусть $p\in\clo{0,1}$ -- есть вероятность того, что ребро проходимо.
Вероятность того, что из узла уровня $n+1$ нет пути по заданному ребру
ни к одному из узлов последнего яруса, равна:
\[(1-p) + p \pi_n\]
Действительно, возможны два случая:
\begin{enumerate}
	\item ребро само по себе проходимо с вероятностью $1-p$;
	\item ребро проходимо, но оно ведёт к узлу, из которого пути нет.
\end{enumerate}
Вероятность последнего события равна $p \pi_n$ по причине того, что
рёбра становятся непроходимыми независимо друг от друга, а значит и
проходимость всего поддерева не зависит от проходимости ребра, ведущего
к его корень.

В силу независимости проходимости рёбер в каждый дочерний узел,
вероятность отсутствия пути из узла уровня $n+1$ равна:
\[ \pi_{n+1} = \brac{ ( 1 - p ) + p \pi_n }^k\]
Относительно вероятности существования пути $\xi_n$ данное выражение
принимает вид:
\[ \xi_{n+1} = 1 - \brac{ ( 1 - p ) + p - p \xi_n }^k = 1 - \brac{ 1 - p \xi_n }^k\]
Действительно, существует путь по данному ребру через его поддерево
к вершинам последнего яруса если одновременно проходимо и ребро и
``растущее'' из него поддерево.

Стоит заметить, что $\xi_0$ есть вероятность существования пути из
узла последнего яруса в некоторый узел опять-таки последнего яруса,
следовательно $\xi_0 = 1$.

Если $p = 1$, то каждое ребро проходимо почти наверное, а значит
путь есть всегда. Действительно, вероятность $\xi_n$, согласно
рекуррентному соотношению, указанному ранее, определяется из:
\[1-\xi_{n+1} = \brac{ 1-\xi_n }^k = \brac{ 1-\xi_0 }^{(n+1)k}\]
Отсюда следует, что $1-\xi_n=0$ для любого $n\geq0$.

Сконцентрируемся на случае, когда $p<1$. Рассмотрим отображение
$f:\clo{0,1}\to \Real$ заданное следующим образом:
\[f(x) \defn 1 - \brac{ 1 - p x}^k\]
Будучи композицией непрерывных функций, $f$ непрерывна.
Производная $f$ равна $f'(x) = p k \brac{1 - p x}^{k-1}$ и строго
положительна на отрезке $\clo{0,1}$.
Действительно, $1 - p x\geq 0$ тогда и только тогда, когда
$x\leq \frac{1}{p}$, что выполняется всегда на отрезке $\clo{0,1}$,
поскольку $p\in\clop{0,1}$.
Более того, $f(0) = 0$ и $f(1) = 1 - \brac{1-p}^k < 1$ (т.к. $p<1$),
что по теореме о монотонной непрерывной функции на отрезке означает
то, что $f$ принимает все значения из интервала $\clo{0,f(1)}$.

Ясно, что $x=0$ является фиксированной точкой отображения $f$.

Рассмотрим последовательность $\brac{\xi_n}_{n\geq 0}$, где
$\xi_{n+1} = f(\xi_n)$ и $\xi_0 = 1$.
Благодаря упомянутым выше свойствам $f$ можно утверждать, что $\xi_n$
представляет собой монотонную последовательность.
И вправду, из $f(1) < 1$ вытекает, что $f(\xi_0)<\xi_0$, откуда по
индукции следует, что $\xi_{n+1}<\xi_n$ для всех $n\geq 0$.

Последовательность $\brac{\xi_n}_{n\geq0}$ является ограниченной,
поскольку $\xi_n\in\clo{0,1}$ для каждого $n\geq 0$, из чего следует
существование подпоследовательности $\brac{\xi_{n_k}}_{k\geq 1}$ сходящейся к
некоторому $\xi$.
Более того $\xi\in \clo{0,1}$, так как $\clo{0,1}$ -- замкнуто.

Поскольку, всякая монотонная последовательность имеет предел и
любая подпоследовательность сходящейся последовательности также
сходится к тому же пределу, то
\[\lim_{n\to \infty} \xi_n = \lim_{k\to \infty} \xi_{n_k} = \xi \]

Из непрерывности $f$ следует:
\[\xi = \lim_{n\to \infty} f(\xi_n) = f\brac{\lim_{n \to\infty}\xi_n} = f(\xi)\]
Значит у $f$ существует фиксированная точка на $\clo{0,1}$.

Если $f'(0)>1$, то в некоторой правой окрестности $0$ существует
такая точка $z\in\ploc{0,1}$, что $f(z)>z$. Поскольку в $x=1$ в
рассматриваемом случае выполнено соотношение $f(x)<x$, то согласно
теореме о нуле непрерывной функции, принимающей значения разных
знаков на границах отрезка, существует $x_0\in \brac{z,1}$ такое, что $f(x_0) = x_0$.

Поскольку функция $f$ строго выпукла вверх, согласно знаку $f''(x)$ всюду на $\clo{0,1}$, можно утверждать, что фиксированная точка единственна. Следовательно, $\xi=x_0$.

Таким образом искомая вероятность существования пути из корня
сбалансированного дерева равна $\xi\in \brac{0,1}$ удовлетворяющему
\[\xi = 1 - \brac{1 - p \xi }^k\]
Это соотношение очень напоминает выражение для критической
вероятности ребра, при которой случайный граф из ансамбля
Эрдёша–Реньи $G_{p,n}$ (\eng{Erd\"os-Renyi}) согласно модели
является связным.

В случае $f'(0)>1$ иных фиксированных точек кроме $x=0$ нет,
поскольку иначе существовала бы такая точка $c\in \brac{0,1}$,
что $f'(c)=1$, что противоречило бы строгой выпуклости $f$.

В случае $p\defn 1-\frac{1}{k}$ и $k=3$ выполняется
\[f'(0) = (1-\frac{1}{k}) k = 2 > 1 \]
откуда вытекает ненулевая вероятность достижения листа дерева из его
корня.
После небольших преобразований, уравнение на предельную вероятность
в данном случае выглядит следующим образом:
\[27 \xi = 27 - \brac{ 3 - 2 \xi }^3\]
Отсюда $27 \xi = ( 54 - 36 \xi + 8 \xi^2 )\xi$, что эквивалентно, с
учётом $\xi>0$, следующему квадратному уравнению:
\[27 - 36 \xi + 8 \xi^2 = 0\]
откуда единственным корнем на интервале $\clo{0,1}$ является
\[\xi = \frac{36 - \sqrt{ 36^2 - 4 \cdot 8\cdot 27}}{16}
= \frac{3^2 - 3 \sqrt{ 9-6 }}{4} = \frac{9 - \sqrt{ 27 }}{4}\]

Таким образом вероятность существования пути из корня в лист в
сбалансированном дереве $k=3$ и $p\sfrac{2}{3}$ равна
$\xi_n \to \xi = \frac{9 - \sqrt{ 27 }}{4}$.

% section task_1_13 (end)



\end{document}
