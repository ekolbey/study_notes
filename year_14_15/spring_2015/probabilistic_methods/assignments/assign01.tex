\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
%\usepackage{fullpage}

\usepackage{graphicx, url}

\usepackage{amsmath, amsfonts, xfrac}
\usepackage{mathtools}

\usepackage{tikz}
\usetikzlibrary{shapes}
\colorlet{light blue}{blue!50}

\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}

\newcommand{\obj}[1]{{\left\{ #1 \right \}}}
\newcommand{\clo}[1]{{\left [ #1 \right ]}}
\newcommand{\clop}[1]{{\left [ #1 \right )}}
\newcommand{\ploc}[1]{{\left ( #1 \right ]}}

\newcommand{\brac}[1]{{\left ( #1 \right )}}
\newcommand{\crab}[1]{{\left ] #1 \right [}}
\newcommand{\induc}[1]{{\left . #1 \right \vert}}
\newcommand{\abs}[1]{{\left | #1 \right |}}
\newcommand{\nrm}[1]{{\left\| #1 \right \|}}
\newcommand{\brkt}[1]{{\left\langle #1 \right\rangle}}

\newcommand{\floor}[1]{{\left\lfloor #1 \right\rfloor}}

\newcommand{\Rbar}{{\bar{\mathbb{R}}}}
\newcommand{\Real}{{\mathbb{R}}}
\newcommand{\Zinf}{{\clo{ 0, +\infty }}}
\newcommand{\Cplx}{{\mathbb{C}}}
\newcommand{\Tcal}{{\mathcal{T}}}
\newcommand{\Dcal}{{\mathcal{D}}}
\newcommand{\Hcal}{{\mathcal{H}}}
\newcommand{\Ccal}{{\mathcal{C}}}
\newcommand{\Scal}{{\mathcal{S}}}
\newcommand{\Ncal}{{\mathcal{N}}}
\newcommand{\Ecal}{{\mathcal{E}}}
\newcommand{\Fcal}{{\mathcal{F}}}
\newcommand{\borel}[1]{{\mathcal{B}\brac{#1}}}
\newcommand{\Ex}[0]{{\mathbb{E}}}
\newcommand{\pr}[0]{{\mathbb{P}}}
\newcommand{\Var}[1]{{\text{Var}\brac{#1}}}

\newcommand{\pwr}[1]{{\mathcal{P}\brac{#1}}}
\newcommand{\Dyns}[1]{{\mathfrak{D}\brac{#1}}}
\newcommand{\Ring}[1]{{\mathcal{R}\brac{#1}}}
\newcommand{\Supp}[1]{{\operatorname{supp}\nolimits\brac{#1}}}

\newcommand{\defn}{{\mathop{\overset{\Delta}{=}}\nolimits}}
\newcommand{\lpto}{{\mathop{\overset{L^p}{\to}}\nolimits}}

\newcommand{\re}{\operatorname{Re}\nolimits}
\newcommand{\im}{\operatorname{Im}\nolimits}

\usepackage[english, russian]{babel}
\newcommand{\eng}[1]{\foreignlanguage{english}{#1}}
\newcommand{\rus}[1]{\foreignlanguage{russian}{#1}}

\title{\rus{Домашняя работа по курсу \\ ``Теоретико-вероятностные методы в статистике''}}
\author{\rus{Назаров Иван,} \rus{101мНОД(ИССА)}}

\begin{document}
\selectlanguage{russian}
\maketitle

\section{У1.8 -- Задача о сборщике купонов} % (fold)
\label{sec:task_1_8}

Пусть $\Omega$ -- множество возможных купонов, $\abs{\Omega} = k$.
Рассмотрим коллекцию $\brac{x_i}_{i=1}^n\in \Omega^n$ купонов на $n$
различимых пачках: $x_i\in \Omega$ для каждого $i=1,\ldots n$.

Для любого $J\subseteq \Omega$ обозначим $A_J$ подмножество
конфигураций $\Omega^n$, в которых не встречаются купоны из $J$ --
то есть множества следующего вида:
\[A_J \defn \obj{ \induc{ \omega\in \Omega^n }\, \omega_i \notin J,\, \forall i = 1,\ldots,n }\]
и для упрощения записи под $A_j$ для $j\in \Omega$ будем понимать
множество конфигураций $A_{\obj{j}}$.

Можно заметить что фактически для любого множества купонов
$J\subseteq \Omega$ справедливо \[A_J = \brac{\Omega\setminus J}^n\]
откуда вытекает, что $\abs{A_J} = \abs{\Omega\setminus J}^n = \brac{\abs{\Omega} - \abs{J}}^n$.
Более того, вполне очевидно, что $A_J = \bigcap_{j\in J} A_j$.

Теперь, по сути наборы конфигураций купонов, в которых не собрано
всех возможных типов купонов из $\Omega$, есть ни что иное как
множество
\[\obj{ \induc{ \omega\in \Omega^n }\,\exists c\in \Omega\, \omega_i \neq c\, \forall i=1\,\ldots n}\]
которое тождественно равно $\bigcup_{c\in \Omega} A_c$.

Количество ``плохих'' конфигураций можно точно получить,
воспользовавшись формулой включений-исключений, которая в данной
постановке задачи принимает вид:
\[\abs{ \bigcup_{c\in \Omega} A_c }
= \sum_{\emptyset \neq J\subseteq \Omega}
\brac{-1}^{\abs{J} - 1} \abs{\bigcap_{c\in J} A_c}
= \sum_{\emptyset \neq J\subseteq \Omega}
\brac{-1}^{\abs{J} - 1} \abs{A_J} \]

Поскольку для любого непустого $J\subseteq \Omega$ мощность
множества $\abs{A_J}$ равна $\brac{\abs{\Omega} - \abs{C}}^n$, то
после сбора подобных слагаемых справедливо:
\begin{align*}
	\abs{ \bigcup_{c\in \Omega} A_c }
	&= \sum_{\emptyset \neq J\subseteq \Omega}
		\brac{-1}^{\abs{J} - 1} \brac{\abs{\Omega} - \abs{J}}^n \\
	&= \sum_{m=1}^k \brac{-1}^{m-1} C^m_k \brac{k - m}^n
\end{align*}
где $C^m_k = \frac{k!}{m!(k-m)!}$ -- число неупорядоченных
комбинаций из $n$ элементов по $k$ штук.

Таким образом искомое множество всех конфигураций, в которых
присутствуют все возможные типы купонов, есть дополнение к
$\bigcup_{c\in \Omega}A_c$ в $\Omega^n$.
Поскольку количество всевозможных конфигураций купонов на $n$
различимых пачках овсянки составляет $k^n$ штук, то мощность
искомого подмножества конфигураций равна
\[f_{n,k} \defn \abs{\Omega^n\setminus \bigcup_{c\in \Omega}A_c }
= k^n - \sum_{m=1}^k \brac{-1}^{m-1} C^m_k \brac{k - m}^n
= \sum_{m=0}^k \brac{-1}^m C^m_k \brac{k - m}^n \]

Комбинаторный смысл полученного выражения состоит в том, что
оно определяет количество разбиений множества из $n$ элементов на $k$
упорядоченных подмножеств.
Итак количество искомых конфигураций, в которых имеется хотя бы один
купон каждого типа из $k$ возможных, задаётся числом $f_{n,k}$
определяемым как
\[f_{n,k} \defn  k! \obj{\begin{matrix} n \\ k \end{matrix}}\]
где $\obj{\begin{matrix} n \\ k \end{matrix}}$
-- число Стирлинга второго рода, отражающее количество разбиений $n$
элементного множества на $k$ непустых неупорядоченных групп.

Таким образом, вероятность того, что в коллекции из $n$ пачек собраны все $k$ возможных типов купонов равна
\[q_n \defn k^{-n} k! \obj{\begin{matrix} n \\ k \end{matrix}}\]
Обязательно выполняется соотношение $q_n\leq q_{n+1}$ поскольку если
в некоторой коллекции из $n$ есть все $k$ купонов, то любая
коллекция из $n+1$, содержащая предыдущую как подколлекцию, тоже
имеет все $k$ купонов.
Также стоит отметить, что $q_n = 0$ для любого $n<k$.

Пусть $N$ -- неотрицательная дискретная случайная величина, равная
объёму купленных упаковок овсянки до того, как будет собрано все $k$
купонов.
Для такой случайной величины вероятность того, что $N>n$ для
некоторого $n\geq1$ равна вероятности того, что в коллекции из $n$
пачек нет хотя бы одного из $k$ купонов.
Более того, если в коллекции $n$ не собраны все купоны, то в любой
её под коллекции тоже недостаёт хотя бы одного купона.
Таким образом $\pr(N>n) = 1-q_n$, откуда следует, что
\[\pr(N=n) = \pr\brac{N>(n-1)} - \pr(N>n) = q_n - q_{n-1} \]

Из рекуррентного соотношения для чисел Стирлинга второго рода, а
именно из
\[\obj{\begin{matrix} n \\ k \end{matrix}} = \obj{\begin{matrix} n-1 \\ k-1 \end{matrix}} + k \obj{\begin{matrix} n-1 \\ k \end{matrix}}\]
следует, что 
\[\pr(N=n) = q_n - q_{n-1} = \frac{k!}{k^n}\brac{ \obj{\begin{matrix} n \\ k \end{matrix}} - k\obj{\begin{matrix} n-1 \\ k \end{matrix}} } = \frac{k!}{k^n} \obj{\begin{matrix} n-1 \\ k-1 \end{matrix}}\]

Производящая функция случайной величины $N$ равна
\begin{align*}
	\Ex\brac{z^N} &= \sum_{n\geq 1} z^n p_n
		= \sum_{n\geq k} \frac{z^n}{k^{n-1}} \sum_{m=0}^{k-1} \brac{-1}^m C^m_{k-1} \brac{k-1 - m}^{n-1} \\
		& = \sum_{m=0}^{k-1} \brac{-1}^m C^m_{k-1} \sum_{n\geq k} z^n \brac{1 - \frac{m+1}{k}}^{n-1} \\
		& = \sum_{m=0}^{k-1} \brac{-1}^m C^{m+1}_k z \frac{m+1}{k} \sum_{n\geq k} z^{n-1} \brac{1 - \frac{m+1}{k}}^{n-1}\\
		& = \sum_{m=1}^k \brac{-1}^{m-1} C^m_k z \frac{m}{k} \sum_{n\geq k} z^{n-1} \brac{1 - \frac{m}{k}}^{n-1} \\
		& = \sum_{m=1}^k \brac{-1}^{m-1} C^m_k \frac{z \frac{m}{k}}{1-z\brac{1 - \frac{m}{k}}} z^{k-1} \brac{1 - \frac{m}{k}}^{k-1}
\end{align*}
% Туговатое выражение() и не ясно, как оно сводится к тому, что ниже...

Посмотрим на задачу с другой стороны: последовательной.
Сбора полного набора купонов на самом деле происходит так: сначала
в пустую коллекцию купонов сборщик добавляет купон, неважно какой
конкретно, с первой пачки овсянки.
Количество пачек необходимое для добавления первого купона может
быть смоделировано вырожденной случайной величиной $K_1$, распределённой
геометрически с параметром $\theta = 1$ (вероятность успеха).

Собрав первый купон, сборщик начинает поиск произвольного второго
купона, отличного от первого: приобретается столько пачек овсянки с
уже собранным купоном, пока не будет получен отличный от него купон.
Вероятность того, что очередной купленный совпадает с первым равна
$\frac{1}{k}$. Таким образом добавление второго купона в коллекцию
равно после покупки $Z_2$ дополнительных пачек овсянки, причём
$Z_2\sim \text{Geom}\brac{\theta=\frac{k-1}{k}}$.

Случайная величина $Z\sim\text{Geom}(\theta)$ принимает значения
$\obj{1,2,\ldots}$ и имеет распределение для $n\geq 1$:
\[\pr(Z=n) \defn \brac{1-\theta}^{n-1} \theta\]
Производящая функция $Z$ равна
\[\Ex(z^Z) = \sum_{n\geq1} z^n \brac{1-\theta}^{n-1} \theta
= \frac{z\theta}{1-z(1-\theta)} \]
причём $\abs{z}<\brac{1-\theta}^{-1}$.

Собрав $i<k$ различных купонов, сборщику необходимо докупать
очередные пачки овсянки до тех пор, пока не будет получена пачка с
купоном отличным от всех из имеющейся коллекции.
Это событие имеет вероятность $1-\frac{i}{k}$ -- шанс того, что
произвольный купон из $\Omega$ не принадлежит некоторому множеству
мощности $i$.
Таким образом количество дополнительных пачек, который нужно
приобрести для нахождения купона, отличного от всех в собранной
коллекции моделируется случайной величиной
$Z_{i+1}\sim \text{Geom}\brac{\theta=\frac{k-i}{k}}$.

Стоит обратить внимание, что каждая серия покупок дополнительных
пачек для поиска очередного купона не зависит ни от предыдущих серий
ни от последующих, а значит случайных величины $Z_i$ независимы.

Эти рассуждения позволяют сделать вывод о том, что количество пачек,
необходимое для сбора всех $k$ купонов выражается случайной величиной
\[N\defn \sum_{i=1}^k Z_i\]
где $Z_i\sim \text{Geom}\brac{\theta=\frac{k-(i-1)}{k}}$ независимы.

Производящая функция $N$ равна
\begin{align*}
	\Ex\brac{z^N} &= \Ex\brac{\prod_{i=1}^k z^{Z_i}}
		= \prod_{i=1}^k \Ex\brac{z^{Z_i}}
		= \prod_{i=1}^k \frac{z\theta_i}{1-z(1-\theta_i)} \\
		& = \prod_{i=1}^k \frac{k-i+1}{k z^{-1}-(i+1)}
\end{align*}
при $\abs{z}<\frac{k}{k-1}$.

Математической ожидание $N$ равно
\[\Ex(N) = \sum_{i=1}^k \Ex(Z_i) = \sum_{i=1}^k \frac{1}{\theta_i}
= \sum_{i=1}^k \frac{k}{k-(i-1)} = \sum_{i=1}^k \frac{k}{i} \]
Благодаря независимости $Z_i$, дисперсия $N$ равна сумме
\[\text{Var}(N) = \sum_{i=1}^k \text{var}(Z_i)\]
В свою очередь, для любого $i=1,\ldots k$
\[\text{var}(Z_i) = \]



% how much wood would a wood chuck chuck if wood chuck could chuck wood
% section task_1_8 (end)


\section{У1.11 -- ``Прореживание'' по Реньи} % (fold)
\label{sec:task_1_11}

Пусть $N$ -- неотрицательная дискретная случайная величина, принимающая
целочисленные значения, с производящей функцией $G(z) = \Ex(z^N)$.
Пусть $\brac{E_k}_{k\geq 1}$ независимые одинаково распределённые дискретные
случайные величины, с производящей функцией $H(z)$.

Рассмотрим случайную величину $S \defn \sum_{k=1}^N E_k$, где предполагается,
что $\sum_{k=1}^N$ равно $0$ при $N=0$. Воспользовавшись свойствами условного
математического ожидания, в том числе ``телескопическим'' свойством, и тем,
что ожидание произведения независимых случайных величин равно произведению
их ожиданий, производящая функция $S$ принимает вид:
\begin{align*}
	F(z) &= \Ex\brac{ z^{\sum_{k=1}^N E_k} }
	= \Ex\brac{ z^{\sum_{k=1}^N E_k} } \\
	& = \Ex\brac{ \Ex\brac{\induc{z^{\sum_{k=1}^N E_k} }\,N} }
	= \Ex\brac{ \Ex\brac{\induc{\prod_{k=1}^N z^{E_k} }\,N} } \\
	& = \Ex\brac{ \prod_{k=1}^N \Ex\brac{\induc{z^{E_k} }\,N} }
\end{align*}
Поскольку $E_k\perp N$ и для любого $k\geq 1$, то $\Ex\brac{\induc{z^{E_k} }\,N}$
равно $\Ex(z^{E_k})$, что, в свою очередь, равно производящей функции величины $E_k$.
Таким образом,
\[F(z) = \Ex\brac{ \prod_{k=1}^N \Ex\brac{\induc{z^{E_k} }\,N} }
= \Ex\brac{ \prod_{k=1}^N H(z) } = \Ex\brac{ \brac{H(z)}^N } = G\brac{H(z)}\]

Положим, что $\brac{E_k}_{k\geq 1}$ есть семейство независимых между собой и
от $N$ одинаково распределённых случайных величин со значениями в $\obj{0,1}$,
причём \[\Pr(E_k = 1) = \alpha \in \clo{0,1}\] для любого $k\geq 1$.
Непосредственные вычисления показывают, что для любого $k\geq1$ справедливо
\[H(z) = \Ex(z^{E_k}) = z^0 (1-\alpha) + z^1 \alpha = 1 + (z-1) \alpha\]

Образуем случайную величину $T_\alpha N$ аналогично $S$: $T_\alpha N \defn \sum_{k=1}^N E_k$
Тогда, $F(z) = G\brac{1 + (z-1) \alpha}$.

Факториальный момент порядка $k$ произвольной случайной величины $X$ с
производящей функцией $G_X$ равен
\[ \Ex X^{\underline{k}} \Ex\brac{X(X-1)\cdot\ldots\cdot(X_k+1)} = \induc{\frac{d^k}{dz^k} G_X(z) }_{z=1}\]

В случае прореженной случайной величины $T_\alpha N$ по правилу взятия
производной от композиции дифференцируемых функций и в силу того, что
$\frac{d}{dz}H(z) = \alpha$, справедливо следующее: 
\[\Ex {T_\alpha N}^{\underline{k}} = \induc{\frac{d^k}{dz^k} G\brac{H(z)} }_{z=1}
= \alpha^k\induc{\frac{d^k}{dx^k} G(x) }_{x=1}\]

Действительно, индукцией по порядку производной $k$ \begin{align*}
	\frac{d^{k+1}}{dz^{k+1}} G\brac{H(z)} & = \frac{d}{dz}\brac{ \frac{d^k}{dz^k} G\brac{H(z)} } = \frac{d}{dz}\brac{ \induc{\frac{d^k}{dx^k} G(x) }_{x=H(z)} \alpha^k }\\
	& = \frac{d}{dz}\brac{ \induc{\frac{d^k}{dx^k} G(x) }_{x=H(z)} \alpha^k } = \induc{\frac{d^{k+1}}{dx^{k+1}} G(x) }_{x=H(z)} H'(z) \alpha^k\\
	\frac{d}{dz} G\brac{H(z)} & = \induc{\frac{d}{dx} G(x) }_{x=H(z)} \frac{d}{dz} H(z) = G'\brac{H(z)} \alpha
\end{align*}

% Прореживание биномиального, отрицательного биномиального, геометрического и Пуассона
%% Dilation

\subsection{Биномиальное распределение} % (fold)
\label{sub:binomial}

Если $N\sim\text{Bin}\brac{p,n}$, то производящая функция $N$ равна
\[G(z) = \sum_{k=0}^n C_n^k p^k \brac{1-p}^{n-k} z^k = \brac{ zp + 1-p }^n\]
Например, в $G$ прослеживаются корни биномиального распределения в сумме
независимых одинаково распределённых Бернуллиевых случайных величин
с вероятностью $p$.

При $\alpha\in \clo{0,1}$, в силу выше сказанного, для прореженной
величины $N$, $T_\alpha N$, справедливо выражение:
\[\Ex\brac{z^{T_\alpha N}} = G\brac{1 + (z-1) \alpha} = \brac{ \alpha p z + 1 - \alpha p }^n\]
Отсюда вытекает, что $\alpha$-прореживание биномиально распределённой
случайной величины с параметром $p$ порождает биномиальную случайную величину
с параметром $\alpha p$.

% subsection binomial (end)

\subsection{Геометрическое распределение} % (fold)
\label{sub:geometric}

Геометрически распределённая случайная величина $N$, отражающая, например,
количество моментов времени до первого наступления некоторого события с вероятностью $\theta$, имеет
распределение вероятности
\[\Pr(N=n) = \brac{1-\theta}^n \theta \]
Из этого следует, что порождающая функция $N$ в этом случае равна
\[G(z) = \sum_{n\geq 0} \brac{1-\theta}^n \theta z^n = \theta \frac{\theta}{1 - z (1-\theta)}\]

%% ПЕРЕПРВЕРИТЬ!!!!!
Порождающая функция $\alpha$-прореженной величины $N$ имеет вид:
\[ \Ex\brac{z^{T_\alpha N}} = G\brac{1 + (z-1) \alpha} = \theta \frac{\theta}{\theta (1-\alpha) + \alpha - z (1-\theta)\alpha }\]

% subsection geometric (end)

\subsection{Распределение Пуассона} % (fold)
\label{sub:Poisson_distribution}


% subsection Poisson_distribution (end)

\subsection{Отрицательное биномиальное распределение} % (fold)
\label{sub:negative_binomial}


% subsection negative_binomial (end)

% section task_1_11 (end)


\section{У1.13 -- Красавица и чудовище} % (fold)
\label{sec:task_1_13}

Согласно условию задачи, структура, образуемая горницами и проходами
между ними, представляет собой не просто связный ациклический граф, а
сбалансированное корневое дерево, в котором у каждого узла есть $k$
дочерних узла.
Горницы соответствуют узлам, а переходы в горницы следующего яруса
-- рёбрам дерева.

Согласно условию задачи красная девица движется по дереву согласно
проходимости рёбер, начиная своё ``блуждание'' с горницы, выходящей на
широкое поле, -- из корневой вершины дерева.

Пусть $\pi_n$ вероятность того, что из некоторого узла уровня $n$
не существует ни одного пути через узлы нижних уровней к листьям дерева
-- к горницам последнего яруса, где есть окна (см. рис~\ref{fig:tree_structure}).

% http://texographie.fr/2014/09/arbres-probabilite-forest/
%% Рисуем часть дерева горниц от уровня {n+1} до {n}
\begin{figure}[htb]\begin{center}
%% Задаём стили вершин дерева и меток рёбер.
	\tikzstyle{tree} = [isosceles triangle, shape border rotate = 90, % isosceles triangle stretching = True,
		fill = none, thick, draw, minimum height = 2em, minimum width = 1cm]
	\tikzstyle{door} = [minimum width = 1em, minimum height = 1em, yshift = -1.5em]
	\tikzstyle{passable} = [midway, fill = white] % , circle, draw]

	\begin{tikzpicture}[level/.style={sibling distance = 15mm/#1, level distance = 25mm }]
	\node [door] (root) {$\pi_{n+1}$} [child anchor = north]
		child { node [tree] (s1) {$\pi_n$} { node[door] {$1$} }
			 edge from parent node [passable] {$p$} }
		child { node [tree] (s2) {$\pi_n$} { node[door] {$2$} }
			 edge from parent node [passable] {$p$} }
		child { node[draw=none] (hidden) {} edge from parent[draw=none] }
		child { node [tree] (sk) {$\pi_n$} { node[door] {$k$} }
			 edge from parent node [passable] {$p$} };
	\path (s2) -- (sk) node [midway, above] {$\cdots$};
	\end{tikzpicture}

	\caption{Общий вид поддерева переходов между комнатами из
	узла уровня $n+1$ через горницы уровня $n$ вниз к ``листьям''.}
\label{fig:tree_structure}
\end{center}\end{figure}

Очевидно, что $\xi_n = 1 - \pi_n$ есть вероятность того, что из узла
уровня $n$ существует хотя бы один путь через горницы последующих
ярусов (уровни уменьшаются с ростом яруса и наоборот).

Пусть $p\in\clo{0,1}$ -- есть вероятность того, что ребро проходимо.
Вероятность того, что из узла уровня $n+1$ нет пути по заданному ребру
ни к одному из узлов последнего яруса, равна:
\[(1-p) + p \pi_n\]
Действительно, возможны два случая:
\begin{enumerate}
	\item ребро само по себе проходимо с вероятностью $1-p$;
	\item ребро проходимо, но оно ведёт к узлу, из которого пути нет.
\end{enumerate}
Вероятность последнего события равна $p \pi_n$ по причине того, что
рёбра становятся непроходимыми независимо друг от друга, а значит и
проходимость всего поддерева не зависит от проходимости ребра, ведущего
к его корень.

В силу независимости проходимости рёбер в каждый дочерний узел,
вероятность отсутствия пути из узла уровня $n+1$ равна:
\[ \pi_{n+1} = \brac{ ( 1 - p ) + p \pi_n }^k\]
Относительно вероятности существования пути $\xi_n$ данное выражение
принимает вид:
\[ \xi_{n+1} = 1 - \brac{ ( 1 - p ) + p - p \xi_n }^k = 1 - \brac{ 1 - p \xi_n }^k\]
Действительно, существует путь по данному ребру через его поддерево
к вершинам последнего яруса если одновременно проходимо и ребро и
``растущее'' из него поддерево.

Стоит заметить, что $\xi_0$ есть вероятность существования пути из
узла последнего яруса в некоторый узел опять-таки последнего яруса,
следовательно $\xi_0 = 1$.

Если $p = 1$, то каждое ребро проходимо почти наверное, а значит
путь есть всегда. Действительно, вероятность $\xi_n$, согласно
рекуррентному соотношению, указанному ранее, определяется из:
\[1-\xi_{n+1} = \brac{ 1-\xi_n }^k = \brac{ 1-\xi_0 }^{(n+1)k}\]
Отсюда следует, что $1-\xi_n=0$ для любого $n\geq0$.

Сконцентрируемся на случае, когда $p<1$. Рассмотрим отображение
$f:\clo{0,1}\to \Real$ заданное следующим образом:
\[f(x) \defn 1 - \brac{ 1 - p x}^k\]
Будучи композицией непрерывных функций, $f$ непрерывна.
Производная $f$ равна $f'(x) = p k \brac{1 - p x}^{k-1}$ и строго
положительна на отрезке $\clo{0,1}$.
Действительно, $1 - p x\geq 0$ тогда и только тогда, когда
$x\leq \frac{1}{p}$, что выполняется всегда на отрезке $\clo{0,1}$,
поскольку $p\in\clop{0,1}$.
Более того, $f(0) = 0$ и $f(1) = 1 - \brac{1-p}^k < 1$ (т.к. $p<1$),
что по теореме о монотонной непрерывной функции на отрезке означает
то, что $f$ принимает все значения из интервала $\clo{0,f(1)}$.

Ясно, что $x=0$ является фиксированной точкой отображения $f$.

Рассмотрим последовательность $\brac{\xi_n}_{n\geq 0}$, где
$\xi_{n+1} = f(\xi_n)$ и $\xi_0 = 1$.
Благодаря упомянутым выше свойствам $f$ можно утверждать, что $\xi_n$
представляет собой монотонную последовательность.
И вправду, из $f(1) < 1$ вытекает, что $f(\xi_0)<\xi_0$, откуда по
индукции следует, что $\xi_{n+1}<\xi_n$ для всех $n\geq 0$.

Последовательность $\brac{\xi_n}_{n\geq0}$ является ограниченной,
поскольку $\xi_n\in\clo{0,1}$ для каждого $n\geq 0$, из чего следует
существование подпоследовательности $\brac{\xi_{n_k}}_{k\geq 1}$ сходящейся к
некоторому $\xi$.
Более того $\xi\in \clo{0,1}$, так как $\clo{0,1}$ -- замкнуто.

Поскольку, всякая монотонная последовательность имеет предел и
любая подпоследовательность сходящейся последовательности также
сходится к тому же пределу, то
\[\lim_{n\to \infty} \xi_n = \lim_{k\to \infty} \xi_{n_k} = \xi \]

Из непрерывности $f$ следует:
\[\xi = \lim_{n\to \infty} f(\xi_n) = f\brac{\lim_{n \to\infty}\xi_n} = f(\xi)\]
Значит у $f$ существует фиксированная точка на $\clo{0,1}$.

Если $f'(0)>1$, то в некоторой правой окрестности $0$ существует
такая точка $z\in\ploc{0,1}$, что $f(z)>z$. Поскольку в $x=1$ в
рассматриваемом случае выполнено соотношение $f(x)<x$, то согласно
теореме о нуле непрерывной функции, принимающей значения разных
знаков на границах отрезка, существует $x_0\in \brac{z,1}$ такое, что $f(x_0) = x_0$.

Поскольку функция $f$ строго выпукла вверх, согласно знаку $f''(x)$ всюду на $\clo{0,1}$, можно утверждать, что фиксированная точка единственна. Следовательно, $\xi=x_0$.

Таким образом искомая вероятность существования пути из корня
сбалансированного дерева равна $\xi\in \brac{0,1}$ удовлетворяющему
\[\xi = 1 - \brac{1 - p \xi }^k\]
Это соотношение очень напоминает выражение для критической
вероятности ребра, при которой случайный граф из ансамбля
Эрдёша–Реньи $G_{p,n}$ (\eng{Erd\"os-Renyi}) согласно модели
является связным.

В случае $f'(0)>1$ иных фиксированных точек кроме $x=0$ нет,
поскольку иначе существовала бы такая точка $c\in \brac{0,1}$,
что $f'(c)=1$, что противоречило бы строгой выпуклости $f$.

В случае $p\defn 1-\frac{1}{k}$ и $k=3$ выполняется
\[f'(0) = (1-\frac{1}{k}) k = 2 > 1 \]
откуда вытекает ненулевая вероятность достижения листа дерева из его
корня.
После небольших преобразований, уравнение на предельную вероятность
в данном случае выглядит следующим образом:
\[27 \xi = 27 - \brac{ 3 - 2 \xi }^3\]
Отсюда $27 \xi = ( 54 - 36 \xi + 8 \xi^2 )\xi$, что эквивалентно, с
учётом $\xi>0$, следующему квадратному уравнению:
\[27 - 36 \xi + 8 \xi^2 = 0\]
откуда единственным корнем на интервале $\clo{0,1}$ является
\[\xi = \frac{36 - \sqrt{ 36^2 - 4 \cdot 8\cdot 27}}{16}
= \frac{3^2 - 3 \sqrt{ 9-6 }}{4} = \frac{9 - \sqrt{ 27 }}{4}\]

Таким образом вероятность существования пути из корня в лист в
сбалансированном дереве $k=3$ и $p\sfrac{2}{3}$ равна
$\xi_n \to \xi = \frac{9 - \sqrt{ 27 }}{4}$.

% section task_1_13 (end)



\end{document}
